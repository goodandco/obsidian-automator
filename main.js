/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var nt=Object.defineProperty;var bt=Object.getOwnPropertyDescriptor;var Et=Object.getOwnPropertyNames;var vt=Object.prototype.hasOwnProperty;var G=(n,r)=>()=>(n&&(r=n(n=0)),r);var M=(n,r)=>{for(var t in r)nt(n,t,{get:r[t],enumerable:!0})},Tt=(n,r,t,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of Et(r))!vt.call(n,s)&&s!==t&&nt(n,s,{get:()=>r[s],enumerable:!(e=bt(r,s))||e.enumerable});return n};var Rt=n=>Tt(nt({},"__esModule",{value:!0}),n);var tt={};M(tt,{sanitizeFileName:()=>dt,sanitizePath:()=>$t});function dt(n){let r=(n!=null?n:"").trim();return Array.from(r).filter(e=>e.charCodeAt(0)>=32).join("").replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").replace(/\.+$/g,"").substring(0,200)||"untitled"}function $t(n){return n?n.split("/").filter(Boolean).map(dt).join("/"):""}var et=G(()=>{});var U={};M(U,{SafeFileManager:()=>at});var at,z=G(()=>{at=class{constructor(r){this.vault=r.vault}async createBatch(r){let t=[];try{for(let e of r)e.type==="folder"?await this.ensureFolder(e.path):await this.createIfAbsent(e.path,e.data)==="created"&&t.push(e.path);return{ok:!0}}catch(e){for(let s of t.reverse())try{let o=this.vault.getAbstractFileByPath(s);o&&this.vault.delete&&await this.vault.delete(o)}catch(o){}return{ok:!1,error:e}}}async has(r){var t;try{return this.vault.getAbstractFileByPath(r)?!0:(t=this.vault.adapter)!=null&&t.exists?await this.vault.adapter.exists(r):!1}catch(e){return!1}}async ensureFolder(r){var e;if(!this.vault.getAbstractFileByPath(r))try{await this.vault.createFolder(r)}catch(s){if(s&&typeof s=="object"&&((e=s.message)!=null&&e.includes("Parent folder"))){let o=r.split("/").filter(Boolean),c="";for(let d of o)if(c=c?`${c}/${d}`:d,!this.vault.getAbstractFileByPath(c))try{await this.vault.createFolder(c)}catch(i){}}}}async createIfAbsent(r,t){if(await this.has(r))return"skipped";try{return await this.vault.create(r,t),"created"}catch(e){return await this.has(r),"skipped"}}}});var pt={};M(pt,{CURRENT_SETTINGS_SCHEMA_VERSION:()=>kt,migrateSettings:()=>jt});function jt(n){var s,o,c;let r={dimensions:(s=n==null?void 0:n.dimensions)!=null?s:[],projectsRoot:(o=n==null?void 0:n.projectsRoot)!=null?o:"1. Projects",schemaVersion:(c=n==null?void 0:n.schemaVersion)!=null?c:0,projectRecords:{}},t=n==null?void 0:n.projectRecords;if(t&&typeof t=="object"&&!Array.isArray(t))r.projectRecords=t;else if(Array.isArray(t)){let d={};for(let i of t){if(!i||!i.info)continue;let l=i.info.dimension,a=i.info.category,p=i.info.id;!l||!a||!p||(d[l]=d[l]||{},d[l][a]=d[l][a]||{},d[l][a][p]=i)}r.projectRecords=d}else r.projectRecords={};if(Array.isArray(r.dimensions)){let d=1;r.dimensions=r.dimensions.map(i=>{var l;if(i&&typeof i=="object"){let a=(l=i.name)!=null?l:"",p=i.order,m=typeof a=="string"?a.match(/^\s*(\d+)\.\s*(.+)$/):null;return m&&(p=parseInt(m[1],10),a=m[2]),(p==null||Number.isNaN(p))&&(p=d++),{name:a,order:p,categories:Array.isArray(i.categories)?i.categories:[]}}return{name:String(i!=null?i:""),order:d++,categories:[]}})}else r.dimensions=[];let e=[...r.dimensions].sort((d,i)=>{var l,a;return((l=d.order)!=null?l:0)-((a=i.order)!=null?a:0)});return e.forEach((d,i)=>{d.order=i+1}),r.dimensions=e,(!r.schemaVersion||r.schemaVersion<2)&&(r.schemaVersion=2),r}var kt,gt=G(()=>{kt=2});var mt={};M(mt,{ensureValidOrThrow:()=>Ct,validateProjectName:()=>Dt,validateTag:()=>_t});function Dt(n){if(!n||!n.trim())return{ok:!1,reason:"Project name is required"};let r=n.trim();if(r.length>120)return{ok:!1,reason:"Project name too long (max 120)"};for(let t of r)if(t.charCodeAt(0)<32||t==="/"||t==="\\")return{ok:!1,reason:"Project name contains invalid characters"};return{ok:!0}}function _t(n){if(!n||!n.trim())return{ok:!1,reason:"Tag is required"};let r=n.trim();return St.test(r)?{ok:!0}:{ok:!1,reason:"Tag must be 2-63 chars, start with letter/digit; may include -, _, /"}}function Ct(n,r){let t=n();if(!t.ok)throw new Error(`${r}: ${t.reason}`)}var St,ut=G(()=>{St=/^[A-Za-z0-9][A-Za-z0-9_/-]{1,62}$/});var yt={};M(yt,{processTemplate:()=>Ft});function ht(n){return n==null?"":String(n)}function Ft(n,r){if(!n||typeof n!="string")return"";let t=n;for(let[e,s]of Object.entries(r)){let o=ht(s),c=`$_${e}`;t.includes(c)&&(t=t.split(c).join(o))}for(let[e,s]of Object.entries(r)){let o=ht(s),c=new RegExp(`\\$\\{${Ot(e)}\\}`,"g");t=t.replace(c,o)}return t}function Ot(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var ft=G(()=>{});var Mt={};M(Mt,{default:()=>Nt});module.exports=Rt(Mt);var k=require("obsidian");var it=require("obsidian"),q=class extends it.Modal{constructor(t,e,s){super(t);this.prompt=e,this.callback=s}onOpen(){let{contentEl:t}=this;t.createEl("h2",{text:this.prompt});let e=t.createEl("input",{type:"text"});e.focus();let s=t.createEl("button",{text:"Submit"});s.onclick=()=>{let o=e.value.trim();this.close(),this.callback(o||null)}}onClose(){let{contentEl:t}=this;t.empty()}};var ct=require("obsidian"),L=class extends ct.Modal{constructor(t,e,s,o){super(t);this.prompt=e,this.choices=s,this.callback=o}onOpen(){let{contentEl:t}=this;t.createEl("h2",{text:this.prompt}),this.choices.forEach(e=>{let s=t.createEl("button",{text:e});s.onclick=()=>{this.close(),this.callback(e)}})}onClose(){let{contentEl:t}=this;t.empty()}};var R=require("obsidian");var lt=require("obsidian"),Z=class extends lt.Modal{constructor(t,e){super(t);this.onResult=e}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("automator-settings"),t.createEl("p",{text:"Do you want skip settings to defaults? This will override all custom settings."});let e=t.createDiv({cls:"gc-row"});e.createDiv({cls:"gc-spacer"});let s=e.createEl("button",{text:"Yes, use defaults"}),o=e.createEl("button",{text:"Go back"});s.onclick=()=>{this.close(),this.onResult(!0)},o.onclick=()=>{this.close(),this.onResult(!1)}}onClose(){this.contentEl.empty()}};var At=[{name:"Business",order:1,categories:["R&D","Jobs","OpenSource","Education"]},{name:"Family",order:2,categories:["Vacations","Parenting","Common"]},{name:"Friends",order:3,categories:[]},{name:"Health",order:4,categories:["Clinics","Issues","R&D"]},{name:"Personal",order:5,categories:["R&D","Languages","SelfManagement","Writing","Reading","Music","Sports"]},{name:"Residence",order:6,categories:[]}],Q={dimensions:JSON.parse(JSON.stringify(At)),projectsRoot:"1. Projects",projectRecords:{}};function xt(n){let r=0;for(let t=0;t<n.length;t++)r=(r<<5)-r+n.charCodeAt(t),r|=0;return r}var X=class extends R.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.addClass("automator-settings");let e=t.createDiv({cls:"gc-row"});e.createDiv({cls:"gc-spacer"});let s=e.createEl("button",{cls:["gc-icon-button","clickable-icon"],attr:{"aria-label":"Reset to defaults",title:"Reset to defaults"}});try{(0,R.setIcon)(s,"rotate-ccw")}catch(a){s.setText("Reset to defaults")}s.onclick=()=>{new Z(this.app,async p=>{p&&(this.plugin.settings=JSON.parse(JSON.stringify(Q)),await this.plugin.saveSettings(),new R.Notice("Settings were reset to defaults."),this.display())}).open()},t.createEl("h2",{text:"Dimensions"}),[...this.plugin.settings.dimensions].sort((a,p)=>{var m,u;return((m=a.order)!=null?m:0)-((u=p.order)!=null?u:0)}).forEach((a,p)=>{let m=t.createDiv({cls:"dimension-setting"}),u=m.createDiv({cls:"dimension-header"});u.addClass("gc-row"),u.createSpan({text:`${a.order}. `});let b=u.createEl("b",{text:a.name});u.createDiv({cls:"gc-spacer"});let h=u.createEl("button",{cls:["gc-icon-button","clickable-icon"]});h.setAttr("aria-label","Move up"),h.setAttr("title","Move up");try{(0,R.setIcon)(h,"arrow-up")}catch(y){h.setText("Up")}h.onclick=async()=>{let f=[...this.plugin.settings.dimensions].filter(E=>{var w,v;return((w=E.order)!=null?w:0)<((v=a.order)!=null?v:0)}).sort((E,w)=>{var v,x;return((v=w.order)!=null?v:0)-((x=E.order)!=null?x:0)})[0];if(!f)return;let P=f.order;f.order=a.order,a.order=P,await this.plugin.saveSettings(),this.display()};let T=u.createEl("button",{cls:["gc-icon-button","clickable-icon"]});T.setAttr("aria-label","Move down"),T.setAttr("title","Move down");try{(0,R.setIcon)(T,"arrow-down")}catch(y){T.setText("Down")}T.onclick=async()=>{let f=[...this.plugin.settings.dimensions].filter(E=>{var w,v;return((w=E.order)!=null?w:0)>((v=a.order)!=null?v:0)}).sort((E,w)=>{var v,x;return((v=E.order)!=null?v:0)-((x=w.order)!=null?x:0)})[0];if(!f)return;let P=f.order;f.order=a.order,a.order=P,await this.plugin.saveSettings(),this.display()};let g=u.createEl("button",{cls:["gc-icon-button","clickable-icon"]});g.setAttr("aria-label",`Delete ${a.name}`),g.setAttr("title",`Delete ${a.name}`);try{(0,R.setIcon)(g,"trash")}catch(y){g.setText("Remove")}g.onclick=async()=>{let y=this.plugin.settings.dimensions.findIndex(f=>f===a);y>=0&&this.plugin.settings.dimensions.splice(y,1),await this.plugin.saveSettings(),this.display()};let A=u.createEl("button",{cls:["gc-icon-button","clickable-icon"]});A.setAttr("aria-label",`Rename ${a.name}`),A.setAttr("title",`Rename ${a.name}`);try{(0,R.setIcon)(A,"pencil")}catch(y){A.setText("Edit")}if(A.onclick=async()=>{var F;let y=a.name,f=b.parentElement;(F=b.detach)==null||F.call(b),A.style.display="none",g.style.display="none";let P=f.createEl("input",{type:"text"});P.value=y,P.addClass("gc-rename");let E=f.createDiv({cls:"gc-row"});E.createDiv({cls:"gc-spacer"});let w=E.createEl("button",{cls:["gc-icon-button","clickable-icon"]});w.setAttr("aria-label","Apply"),w.setAttr("title","Apply");try{(0,R.setIcon)(w,"check")}catch($){w.setText("Apply")}let v=E.createEl("button",{cls:["gc-icon-button","clickable-icon"]});v.setAttr("aria-label","Discard"),v.setAttr("title","Discard");try{(0,R.setIcon)(v,"x")}catch($){v.setText("Discard")}let x=()=>{this.display()},_=async $=>{let S=$.trim();if(!S||S===y){x();return}if(this.plugin.settings.dimensions.some(B=>B!==a&&B.name===S)){new R.Notice("A dimension with this name already exists.");return}a.name=S,await this.plugin.saveSettings(),x()};w.onclick=async()=>{await _(P.value)},v.onclick=()=>x(),P.focus(),P.select(),P.onkeydown=async $=>{$.key==="Enter"&&await _(P.value),$.key==="Escape"&&x()},P.onblur=async()=>{await _(P.value)}},a.categories.length>0){let y=m.createDiv({cls:"categories-list gc-list"});a.categories.forEach((f,P)=>{var B;let E=y.createDiv({cls:"gc-list-item gc-row"}),w=this.plugin.settings.projectRecords||{},v=a.name,x=Object.keys(((B=w==null?void 0:w[v])==null?void 0:B[f])||{}),_=E.createEl("b",{text:f}),F=E.createDiv({cls:"gc-id-wrap"});x.length>0&&(F.createSpan({text:" "}),x.forEach((C,W)=>{let j=F.createSpan({cls:"gc-id-tag",text:C}),O=Math.abs(xt(C))%360;j.style.backgroundColor=`hsl(${O}, 70%, 90%)`,j.style.color=`hsl(${O}, 70%, 25%)`,W<x.length-1&&F.createSpan({text:" "})})),E.createDiv({cls:"gc-spacer"});let $=E.createEl("button",{cls:["remove-category","gc-icon-button","clickable-icon"]});$.setAttr("aria-label",`Delete ${f}`),$.setAttr("title",`Delete ${f}`);try{(0,R.setIcon)($,"trash")}catch(C){$.setText("Remove")}$.onclick=async()=>{a.categories.splice(P,1),await this.plugin.saveSettings(),this.display()};let S=E.createEl("button",{cls:["gc-icon-button","clickable-icon"]});S.setAttr("aria-label",`Rename ${f}`),S.setAttr("title",`Rename ${f}`);try{(0,R.setIcon)(S,"pencil")}catch(C){S.setText("Edit")}S.onclick=async()=>{var ot;let C=a.categories[P],W=_.parentElement;(ot=_.detach)==null||ot.call(_),S.style.display="none",$.style.display="none";let j=W.createEl("input",{type:"text"});j.value=C,j.addClass("gc-rename");let O=W.createDiv({cls:"gc-row"});O.createDiv({cls:"gc-spacer"});let I=O.createEl("button",{cls:["gc-icon-button","clickable-icon"]});I.setAttr("aria-label","Apply"),I.setAttr("title","Apply");try{(0,R.setIcon)(I,"check")}catch(N){I.setText("Apply")}let J=O.createEl("button",{cls:["gc-icon-button","clickable-icon"]});J.setAttr("aria-label","Discard"),J.setAttr("title","Discard");try{(0,R.setIcon)(J,"x")}catch(N){J.setText("Discard")}let K=()=>{this.display()},rt=async N=>{let Y=N.trim();if(!Y||Y===C){K();return}if(a.categories.some((wt,Pt)=>Pt!==P&&wt===Y)){new R.Notice("This category already exists in the dimension.");return}a.categories[P]=Y,await this.plugin.saveSettings(),K()};I.onclick=async()=>{await rt(j.value)},J.onclick=()=>K(),j.focus(),j.select(),j.onkeydown=async N=>{N.key==="Enter"&&await rt(j.value),N.key==="Escape"&&K()},j.onblur=async()=>{await rt(j.value)}}})}let D=m.createDiv({cls:"add-category gc-row"}),H=D.createEl("input",{type:"text",placeholder:"New category"});D.createDiv({cls:"gc-spacer"});let V=D.createEl("button",{text:"Add Category"});V.onclick=async()=>{let y=H.value.trim();y&&!a.categories.includes(y)&&(a.categories.push(y),await this.plugin.saveSettings(),this.display())}});let c=t.createDiv({cls:"add-dimension"});c.createEl("h3",{text:"Add new dimension"});let d=c.createDiv({cls:"gc-row"}),i=d.createEl("input",{type:"text",placeholder:"Dimension name"});d.createDiv({cls:"gc-spacer"});let l=d.createEl("button",{text:"Add Dimension"});l.onclick=async()=>{let a=i.value.trim();if(a&&!this.plugin.settings.dimensions.some(p=>p.name===a)){{let p=this.plugin.settings.dimensions.reduce((m,u)=>{var b;return Math.max(m,(b=u.order)!=null?b:0)},0);this.plugin.settings.dimensions.push({name:a,order:p+1,categories:[]})}await this.plugin.saveSettings(),this.display()}}}};var st=class extends k.Plugin{async deleteProjectById(t,e,s){var m,u,b,h,T;let o=(b=(u=(m=this.settings.projectRecords)==null?void 0:m[t])==null?void 0:u[e])==null?void 0:b[s];if(!o)return;let c=o.variables,{sanitizePath:d}=await Promise.resolve().then(()=>(et(),tt)),{SafeFileManager:i}=await Promise.resolve().then(()=>(z(),U)),l=new i(this.app),a=d(c.PROJECT_PATH),p=d(`Templates/${o.info.name}_Templates`);try{let g=this.app.vault,A=g.getAbstractFileByPath(a);A&&g.delete&&await g.delete(A,!0);let D=g.getAbstractFileByPath(p);D&&g.delete&&await g.delete(D,!0)}catch(g){console.warn("Failed to delete some files for project",s,g)}try{let g=this.settings.projectRecords;(T=(h=g==null?void 0:g[t])==null?void 0:h[e])!=null&&T[s]&&(delete g[t][e][s],Object.keys(g[t][e]).length===0&&delete g[t][e],Object.keys(g[t]).length===0&&delete g[t]),await this.saveSettings()}catch(g){console.warn("Failed to update projectRecords after delete",g)}}async onload(){console.log("ProjectFlow plugin loaded"),await this.loadSettings(),this.addSettingTab(new X(this.app,this)),this.addCommand({id:"add-project-info",name:"Add Project Info",callback:()=>this.showProjectPrompt()})}async loadSettings(){let t=await this.loadData();try{let{migrateSettings:e}=await Promise.resolve().then(()=>(gt(),pt));this.settings=Object.assign({},Q,e(t))}catch(e){this.settings=Object.assign({},Q,t)}}async saveSettings(){await this.saveData(this.settings)}async showProjectPrompt(){var u,b;let t=await this.promptForText("Enter project name:");if(!t){new k.Notice("Project creation cancelled. No project name provided.");return}let e=await this.promptForText("Enter project tag:");if(!e){new k.Notice("Project creation cancelled. No project tag provided.");return}let s=await this.promptForText("Enter Project ID (used for task prefixes):");if(!s){new k.Notice("Project creation cancelled. No Project ID provided.");return}let o=await this.promptForText("Enter parent name (optional):"),c=o&&o.trim().length>0?o.trim():null,d=[...this.settings.dimensions].sort((h,T)=>{var g,A;return((g=h.order)!=null?g:0)-((A=T.order)!=null?A:0)}).map(h=>h.name),i=await this.promptForChoice("Select dimension:",d);if(!i){new k.Notice("Project creation cancelled. No dimension selected.");return}let l=this.settings.dimensions.find(h=>h.name===i);if(!l||l.categories.length===0){new k.Notice("Selected dimension has no categories. Please add categories in settings first.");return}let a=l.categories,p=await this.promptForChoice("Select category:",a);if(!p){new k.Notice("Project creation cancelled. No category selected.");return}let m={name:t,tag:e,id:s,parent:c,dimension:i,category:p};try{let h=this.settings.projectRecords;if(h&&!Array.isArray(h)&&((b=(u=h[i])==null?void 0:u[p])==null?void 0:b[s])){new k.Notice(`Project with ID "${s}" already exists in ${i}:${p}. Choose a different ID.`);return}}catch(h){}try{let{validateProjectName:h,validateTag:T,ensureValidOrThrow:g}=await Promise.resolve().then(()=>(ut(),mt));g(()=>h(m.name),"Invalid project name"),g(()=>T(m.tag),"Invalid tag"),g(()=>T(m.id),"Invalid Project ID")}catch(h){let T=h.message||"Invalid input";console.error("Validation error:",h),new k.Notice(T);return}await this.createProject(m)}async promptForText(t){return new Promise(e=>{new q(this.app,t,e).open()})}async promptForChoice(t,e){return new Promise(s=>{new L(this.app,t,e,s).open()})}generateProjectVariables(t){let e=new Date,s=e.getFullYear().toString(),o=e.toISOString().split("T")[0],c=this.settings.projectsRoot||"1. Projects",d=t.parent&&t.parent.trim().length>0?`.${t.parent.trim()}`:"",i=`${s}${d}.${t.name}`,l=this.settings.dimensions.find(u=>u.name===t.dimension),a=l?`${l.order}. ${l.name}`:t.dimension,p=`${c}/${a}/${t.category}/${i}`,m=`${p}`;return{PROJECT_NAME:t.name,PROJECT_TAG:t.tag,PROJECT_PARENT:t.parent?t.parent:"",PARENT_TAG:t.parent?t.tag:"",YEAR:s,DATE:o,PROJECT_FULL_NAME:i,PROJECT_RELATIVE_PATH:p,PROJECT_PATH:m,DIMENSION:l?l.name:t.dimension,CATEGORY:t.category,PROJECT_ID:t.id,PROJECT_DIMENSION:l?l.name:t.dimension}}async processTemplate(t,e){try{let{processTemplate:s}=await Promise.resolve().then(()=>(ft(),yt));return s(t,e)}catch(s){console.warn("Template processor import failed, using legacy replacement:",s);let o=t;return Object.entries(e).forEach(([c,d])=>{let i=`$_${c}`;o=o.split(i).join(d)}),o}}async createProject(t){try{let e=this.generateProjectVariables(t),s=this.settings.projectsRoot||"1. Projects",{sanitizePath:o,sanitizeFileName:c}=await Promise.resolve().then(()=>(et(),tt)),{SafeFileManager:d}=await Promise.resolve().then(()=>(z(),U)),i=new d(this.app),l=o(s),a=this.settings.dimensions.find(y=>y.name===t.dimension),p=a?`${a.order}. ${a.name}`:t.dimension,m=c(p),u=c(t.category),b=o(`${l}/${m}/${u}/${e.PROJECT_FULL_NAME}`),T=[{type:"folder",path:b},...["Knowledge Base","Meetings","Work","Work/Tasks","People"].map(y=>({type:"folder",path:o(`${b}/${y}`)}))],g=this.app.vault.adapter,A=`.obsidian/plugins/${this.manifest.id}/src/templates`,D=[{fileName:`${e.PROJECT_FULL_NAME}.md`,template:"project.md"},{fileName:`${t.name} Meetings.md`,template:"meetings.md"},{fileName:`${t.name} People.md`,template:"people.md"},{fileName:`${t.name} Work.md`,template:"work.md"}],H=[];for(let y of D){let f=`${A}/${y.template}`;if(!await g.exists(f))throw new Error(`Template file not found: ${y.template}`);let P=await g.read(f),E=await this.processTemplate(P,e),w=o(`${b}/${c(y.fileName)}`);H.push({type:"file",path:w,data:E})}let V=await i.createBatch([...T,...H]);if(!("ok"in V)||!V.ok)throw new Error(`Batch creation failed: ${V.error||"unknown"}`);await this.createProjectTemplates(t.name,e),await this.recordProjectCreation(t,e),new k.Notice(`Project "${t.name}" created successfully!`)}catch(e){new k.Notice(`Error creating project: ${e}`),console.error("Project creation error:",e)}}async recordProjectCreation(t,e){try{let s={info:t,variables:e,createdAt:new Date().toISOString()},o=t.dimension,c=t.category,d=t.id;if(!this.settings.projectRecords||Array.isArray(this.settings.projectRecords)){let l={},a=Array.isArray(this.settings.projectRecords)?this.settings.projectRecords:[];for(let p of a){let m=p.info.dimension,u=p.info.category,b=p.info.id;l[m]=l[m]||{},l[m][u]=l[m][u]||{},l[m][u][b]=p}this.settings.projectRecords=l}let i=this.settings.projectRecords;if(i[o]=i[o]||{},i[o][c]=i[o][c]||{},i[o][c][d])throw new Error(`Project with id "${d}" already exists in ${o}:${c}`);i[o][c][d]=s,await this.saveSettings()}catch(s){throw console.warn("Failed to record project creation:",s),s}}async ensureDirectoryExists(t){let{SafeFileManager:e}=await Promise.resolve().then(()=>(z(),U));await new e(this.app).ensureFolder(t)}async createProjectFile(t,e,s,o){try{let c=this.app.vault.adapter,d=`.obsidian/plugins/${this.manifest.id}/src/templates/${s}`;if(console.log("Template: "+d),!await c.exists(d))throw new Error(`Template file not found: ${s}`);let i=await this.app.vault.adapter.read(d),l=await this.processTemplate(i,o),a=`${t}/${e}`,{SafeFileManager:p}=await Promise.resolve().then(()=>(z(),U));await new p(this.app).createIfAbsent(a,l)}catch(c){throw console.error(`Failed to create ${e}:`,c),new Error(`Failed to create ${e}: ${c}`)}}async createProjectTemplates(t,e){let{sanitizePath:s,sanitizeFileName:o}=await Promise.resolve().then(()=>(et(),tt)),c=s(`Templates/${t}_Templates`);await this.ensureDirectoryExists(c);let d=[{source:"template-meeting-daily.md",target:`${t}_Meeting_Daily_Template.md`},{source:"template-meeting-discussion.md",target:`${t}_Meeting_Discussion_Template.md`},{source:"template-meeting-knowledge.md",target:`${t}_Meeting_Knowledge_Template.md`},{source:"template-meeting-planning.md",target:`${t}_Meeting_Planning_Template.md`},{source:"template-meeting-refinement.md",target:`${t}_Meeting_Refinement_Template.md`},{source:"template-meeting-retro.md",target:`${t}_Meeting_Retro_Template.md`},{source:"template-meeting-demo.md",target:`${t}_Meeting_Demo_Template.md`},{source:"template-sprint.md",target:`${t}_Sprint_Template.md`},{source:"template-task.md",target:`${t}_Task_Template.md`},{source:"template-idea.md",target:`${t}_Idea_Template.md`}];for(let i of d)try{let l=o(i.target);await this.createProjectFile(c,l,i.source,e)}catch(l){console.warn(`Failed to create template ${i.target}: ${l}`)}}};var Nt=st;
